#define BLOCKS 100

/* MD5C.C - RSA Data Security, Inc., MD5 message-digest algorithm
 */

/* Copyright (C) 1991-2, RSA Data Security, Inc. Created 1991. All
rights reserved.

License to copy and use this software is granted provided that it
is identified as the "RSA Data Security, Inc. MD5 Message-Digest
Algorithm" in all material mentioning or referencing this software
or this function.

License is also granted to make and use derivative works provided
that such works are identified as "derived from the RSA Data
Security, Inc. MD5 Message-Digest Algorithm" in all material
mentioning or referencing the derived work.

RSA Data Security, Inc. makes no representations concerning either
the merchantability of this software or the suitability of this
software for any particular purpose. It is provided "as is"
without express or implied warranty of any kind.

These notices must be retained in any copies of any part of this
documentation and/or software.
 */

#define PROTOTYPES 0

/* POINTER defines a generic pointer type */
typedef unsigned char *POINTER;

/* UINT2 defines a two byte word */
typedef unsigned short int UINT2;

/* UINT4 defines a four byte word */
typedef unsigned long int UINT4;

// Seed 0
UINT4 states[4*BLOCKS] = {
    -1155484576, -723955400, 1033096058, -1690734402, -1557280266, 1327362106, -1930858313, 502539523, -1728529858, -938301587, 1431162155, 1085665355, 1654374947, -1661998771, -65105105, -73789608, -518907128, 99135751, -252332814, 755814641,
    1180918287, 1344049776, 553609048, 1580443894, 629649304, -1266264776, 99807007, 5955764, -1946737912, 39620447, -152527805, -1877116806, 448784075, 1086124775, -1609984092, 1227951724, 1764356251, 64111306, -960731419, -100082026,
    -39845375, -1339022546, 2092649110, -568315836, -1089884900, -81839914, -1146103148, -1846688624, -784703072, 55004124, -691960657, 1770461755, -2032810463, -1177788003, -432352882, -65824064, 575267217, -1949367821, 356750287, 798819494,
    -92022521, 1318001577, -1192467086, -1412716779, -1223932479, 276053035, 615126903, 1542603436, 1988388716, 1177882237, 19265476, -1430871151, 307082914, -1333570194, 1496453452, -790542135, 1455004595, -1690249972, -604059026, -290476856,
    -122204761, -1097539750, -576617062, -2002123957, -1663951485, 193034304, 768747578, 1337360486, 934457803, 873612482, -624972850, 355564760, 41547336, 1781447028, -1321591463, 1081281446, -982203381, -222544851, -1233998085, -1331702554,
    907249073, 206843130, -931610657, 1697401307, -234791961, -996341162, 61144662, -1638496702, 1693091376, -1667947369, -627963836, 105673451, -918940699, -300903254, -28037702, 1358495114, -502062723, 2056481282, 731396580, 617380302,
    -162912754, 818693069, -1184143835, -410943565, -1385753324, 1233308008, -840115328, -1474241772, 1895913584, 1376826901, 1984652857, 412901507, -632101198, 2025024491, -2139603013, -1233011876, -34604646, -1854979571, -131984708, -1866233577,
    1516579035, 1612513822, 203005342, -911714850, 307621155, 13453556, 125015832, 483675743, 2077347671, 37011083, -120473323, 2069609186, -46741469, 1502566715, -998828580, -1206282339, -2141482063, -1550311379, 1097472880, 1449582151,
    1327824311, -1105846005, -651630279, -1174121238, 223701431, 810978550, 43703267, 835843581, 1519786882, -772329283, 372536197, -317962831, -642907139, -706495414, 15792134, -1116133237, 1322391079, -1231319713, -2011725892, 1299386162,
    -348690342, 1341976962, 1190607957, -262501494, -540039728, -986836170, -1675546118, -1948015872, -392391576, 638256747, 191085745, -97160665, -1517309270, 1375971382, 2133755906, 891811204, -2118700536, 2110473668, -2058625827, 861211557,
    1573507430, 1625767564, 2051434938, -1922104200, -1271440420, 927536580, 1386277121, 1184911833, 50057146, -185358571, -1284027987, -1025692308, -1093701172, -1116573039, -1686684117, 2068400044, 1009668318, -1847249948, 1670927751, 408998980,
    -380240510, 1439774921, 718930634, -1800042595, 16808464, -1743967552, 1137718941, 252008887, -460347667, -1053605891, 1278046001, 947528252, 1842130704, 1599145891, -1341955486, 1631478226, 1754478786, -1370798799, 1516348954, 730123440,
    -1409786204, 1491046204, -1114899725, -656053644, -453397258, -694901410, -1804067552, 13393714, -2101289195, 176533870, 1339899789, -1511804464, -1974699707, -1660688399, -115501757, 86156176, -1659413839, 1775057871, 116690193, -524129043,
    -1335659601, -1387390647, -1587895448, 1291940779, -782382009, -129016790, -1111888250, 1369132585, -1582995723, 1775301948, 1352452311, -898816007, -1072231506, 98890493, 816987543, 1763924914, 526139168, -312090222, -1231414341, 977688068,
    -287577538, -1465993732, 1336202001, -1765140980, -2020641285, 95008905, 768704422, -1985683736, 489119572, 1303323276, -1357461657, -869863794, 1628866452, -779918512, -1750503926, 219565529, -255081261, 1102069833, -2000829650, 187633124,
    919959231, -1628224372, 1433358016, -2066119013, 1076044702, 837759872, -1135845471, 1374513806, 391471507, 980775637, 1136222341, 1920058376, 810323999, 1940365237, 1278875422, 330772320, -1037359638, 562086714, 200094072, -1255479666,
    369661635, -782706145, -462895706, -1256820224, -1998711323, -252927047, 367830942, -1133964626, -2012825476, -1180767193, 315210081, 753219948, 759217255, -146291256, -500459170, -539123842, 1505097534, -298228243, -60533992, 38982769,
    -1821527659, 174692559, -1699744250, -1761913560, 1172992642, 1026162883, -2090846535, 1556971572, -237338788, -1631021909, 935231044, 1514404713, -387312699, 1628770735, 83168215, -1073062227, 1177720299, -1503701971, -1422521171, -230082541,
    1236421386, -514995219, 274845224, 1537588519, 971788340, -332759143, 601583161, -646267509, -1702306988, -1388817557, -1169314299, -1961514302, 1305086064, 2022278952, -1609053499, 521914699, 153728813, 971743052, 2050261229, 1072226033,
    398015640, 168570246, -1242849904, -352718239, 1864625443, 473771110, -775896574, -1785991171, -1698577684, -713629100, -1407697474, 1522485231, 1933026373, 1956675524, 1479877258, -1156654721, 1157041776, -1895306073, -1094584616, -218513495
};


UINT4 x[16*BLOCKS] = {
    -1155869325, 431529176, 1761283695, 1749940626, 892128508, 155629808, 1429008869, -1465154083, -138487339, -1242363800, 26273138, 655996946, -155886662, 685382526, -258276172, -1915244828, -226796111, -382464772, -270230103, 2092024379,
    1705850753, -369526632, 1492578621, 684358198, 1262965348, 1584853918, -2119636700, -582126989, 498074875, -1978864692, -985540886, -1789481587, -1460749695, 181670012, 673222727, -1023599386, 1624365379, -1615025656, 600276151, -518561627,
    -1310188465, 1933673321, -836540342, 20841474, 21582955, -634566111, -2048118856, 100579776, -1099578295, -1266972581, 609982904, 1181244667, 2069007352, 323788111, -1956122223, -1672496605, -1816340580, -193570837, 880097008, 1177117768,
    -1617640095, 816912303, 793310972, 5577367, 45889196, -1359243304, 691675816, 2088469028, 764739731, 2093861056, -1973979577, 543635433, -112382065, 559242116, 1054099045, 885948174, 1694454384, -662903833, 934594003, 1746079594,
    1855455376, -215436171, 1001396483, -2058237879, -472838325, 1663228139, 164612758, 1165249391, -1750717778, 484561621, -1481018061, 982697053, 514704749, -34866055, -1492601190, -1777049646, -67333094, -162286093, 887930872, 1138833300,
    1609107348, 1558626465, 1990072188, -522144145, 1432844988, 1248685248, 1903583017, 220969086, -2129721489, 788299095, -4377362, -1559630936, -1587398993, 1193731667, -388333581, 1464218733, -2114584541, 1141557491, 2110766901, 501095138,
    1841614017, 587682406, 1323248980, -1949531143, -1214091063, 2124374193, -161428053, 66075398, 899764468, 1541870038, 741521057, 1041436542, -1937234195, -854023886, -1909248706, 471763713, -1770317568, -2066794714, -905419263, -2032696423,
    -1292756720, 1546424057, 878903023, 1900678724, 1094827726, -1290234115, -953841937, 748918191, 966463784, -1290244369, -72571307, -305063612, -843451650, -1121163101, -703021893, 387176550, 700524315, 1878716128, -1556936681, 1377758715,
    37625698, -1484228984, -1584027382, 1601478698, 893258567, -384115204, -513861514, 1306683493, -1258235519, -823599426, -1188109742, 1835464617, -2106711811, 236746071, -55395904, 599636740, 658187541, -1732680838, -1243071905, -226515880,
    -755996415, -2107166615, 531163870, -1484702883, -1645181299, -1255126121, 2069583057, 1142045419, 428424204, 272512398, -1644345913, -1757200775, 120776076, 1219810066, -1754755685, -2036710432, 313644362, 1112362630, 318033418, 1206322533,
    -1374666904, -1535956081, 1202597766, 1517580277, -1700877091, 665612534, -645787831, 1575270834, 1519659436, -1874850606, -1723860308, 1037687982, 1254531672, 77321958, -530674760, -748389899, -1098439530, -1976707769, 1817770749, -1538299695,
    1614083908, -126179518, 1165195938, -587303352, -1160397415, -898286980, -486428995, -671409943, 187701662, 1874472537, 1965807332, 1454513351, -590773795, 1284737441, -421233404, 361860038, 268385879, -1898994079, -1014383248, 1122391573,
    1836957882, -1732216817, -3507139, -137527558, 265866195, -1587113999, -1776739380, -1920675372, -1858462143, -1961000002, -1451587417, 866345822, -398224277, -11167100, 1058647697, -1249746128, 1067251123, -532618291, -1259033897, -626851445,
    1450500331, -954721027, -1686482964, 929459541, 1354730503, -520222466, 105106996, -717672862, 1937066772, 1137581598, 1585419807, -1818009612, 1992168040, 562933303, 761251706, 180588421, -1391040485, -754651889, -1221606911, -1814936637,
    -1102219083, -361268990, -304501960, -1180143653, -1761393880, -1530246690, -1528955526, 35870458, 474550272, -1948308979, -968068014, -706436080, 1316333528, -1093919239, -512824823, 1586870742, -1587413744, -1911071317, -305399169, -524189934,
    844774588, 1099351221, -1053786306, 1036528409, 677018335, 1822153810, 181156043, -1868245355, 1626172888, 214164427, -916506305, -445328248, -1233720037, 1255504667, 473621527, -869460080, -1021630684, -2031365163, 129144647, 1793730412,
    1359921833, -599159739, -1429909100, -267687234, 1831558927, 2028706006, 1720379939, 269666578, -1100535778, -1944657997, 1568976204, 323873054, -1014664969, -1498322257, 1385853619, -606171317, -2092856764, -907914391, 2055897241, 34332788,
    563365810, 176278955, 136564847, 1931381996, 1908926620, 1150612498, -1324906324, -223991867, -1206560760, 1604795124, -953696289, 119942735, 1237383126, -980570755, -939074297, -1911716897, -144938186, -146908901, -14931678, -943495727,
    1026954330, 1361611547, 1912038915, -1077863473, 559298924, -1474247532, 1007058536, -1503664046, -1477114686, 733841539, -1837259957, -428409496, -1907108784, 154167351, 1075014264, 1616738744, -342389666, 1685647855, -1186479521, 1788916163,
    -957816454, 193291713, 1040568107, -1224783508, 754634158, -1850780484, 1910375699, 1950212537, -731470602, 2017496657, -1709763601, 1936875227, -1555006228, 2089746414, 1302951949, 1974405739, 280878021, -872125717, -266156987, 1439110646,
    1144251008, -1806625623, 984283466, -2055585349, 1305568859, 1750521080, 1597472322, 1441639346, -613634679, 592193209, -828600679, 221514448, 1669579554, 426581700, 1139224850, -1375217015, 139040347, 1787456779, -1418261474, 670972566,
    319379702, 2099563519, -1678726287, -39745800, 767348987, -87719374, 127273681, 659483708, -1253469784, -299181507, 1193048624, 1973582847, 497307557, -605440797, -1326174467, 418481588, 1498989691, 882088310, 979834550, 1695233956,
    719836487, 1451419769, -1741046079, -713831370, -816516950, 1667568774, -2083363460, -1362180240, 1498863619, 2092238194, 228034706, 309397693, -1691400224, -120190546, -1367833456, -1453607696, -1787808847, -492701201, 1588074935, 812465288,
    -231962434, -1924959471, -1346770413, -1465515467, 964537434, 1348422200, 1909540044, 3302811, -1255790248, 454991672, 127980219, -71027115, -1465040706, -1713557194, 1356855360, -2015243461, -791260744, 810932623, 668205138, 2003925480,
    1947356367, 862015736, 1373136086, -466908554, -1934055846, 670671589, -2051880908, -1090075765, 1354267700, -1955138769, -1305185240, -1101153639, 407495343, -517965328, -176918059, 1572672608, 556960967, -1384719951, 101355295, 1950237111,
    363873178, 1179333575, 224716089, 1783284876, 2018435351, 839425785, -774458244, -85966551, -132726282, 1590420582, 1503177082, -550641736, 1172038375, 222275237, 48226131, -1175993847, -884663027, -1846454483, 431108934, 171282833,
    -777636435, 1547017719, -1082933877, 418212277, 1631499554, 972625762, 462586719, 1981588040, -1004881644, -297497515, 896710239, 1022639698, -235784727, -1559623510, 118428953, 2034696979, -1086956678, -398298166, -1561968417, -2145158329,
    -263974646, 414814100, 403119327, 619997866, -173163405, -1973386878, -778335632, -2110360130, 922601633, -1294120434, -713943378, -1468399157, 1098293060, -745550254, -1543738040, 1280610598, -1217656383, 682317806, -851336041, 1549082550,
    1981623657, 2005774125, 513849075, -415022157, -2102028564, 258683754, -1104102078, -1859578191, 244254991, 1593415088, -1890468143, -282842404, 1580532380, -1875306080, -505795994, -285601659, -515493990, -1290370921, 259673237, 607203293,
    308230590, -828505329, 984635218, -1456014593, 956148769, 1226439749, -1522741561, -1272398797, 1258348082, -268555236, -491753624, 207914096, -1957029395, 455783233, -1280712381, -61080030, 786198860, -232772209, 1491782812, -226809810,
    170915582, 1601212083, 1070670776, -795787982, -873247146, 1162781971, -1254443527, 2068466449, 2001847942, -1210554645, -844734422, -416530770, 352548108, 1825992121, 2059890204, -26056714, -166722709, -412269605, 1022689649, -414270940,
    1946428446, -1092392843, 2066256311, -1933030336, 282387145, 1953050008, 467392952, -1176314392, -458538063, -1157770080, -582498801, 2134074450, -863639954, -1604350756, 1502296318, 717349776, 558211038, 1420441716, -463882369, -2124867562,
    1855274845, 706943879, 557798296, -1687636871, -1418988750, -34743917, -2071435277, 1051146105, -1913847733, 1598645530, -357500755, -2064867775, 1633599789, 867812737, 740871534, 1485797100, 572399653, 493737786, 2054592697, -886958261,
    -535625533, -864130523, 1771421828, -1794769947, -2021831544, -2053742029, -1576035317, 1864864574, 691640030, 1332330060, 1057635040, 1150613852, -635990968, 1314630002, 211028294, 63334278, -473194279, 689044006, 118810048, -1214817202,
    -1666666006, -742996982, 1245871076, 1650180050, 350588678, -1467031609, -981534604, 980191294, 1543347753, 1033276720, -1704564050, -2093243756, 1576734506, 1313051559, -1581226270, 2025268143, -496217484, 1486783679, -1471103419, 146802052,
    -1532115204, 467338531, 291201029, 1475933355, -1706306706, 112279477, -1923303523, 7729693, -2016354647, 1127802618, -373744535, 1377684799, -241837202, 2133354676, -281336196, -1709524449, 744708947, -933152816, 711064753, 415729660,
    -333685507, -253996926, -16912384, 408632331, -1131722355, 1754815150, -777324526, -764603272, -1795369638, 2052918921, 1922950422, 193410986, 1776007137, 1597882240, 1999788757, -1835101237, -1422168327, -687918760, 1341450500, -89476473,
    -479231670, 1864571798, -1194994472, -956267245, -1196428289, -1851916512, -2056886304, -71340944, -140318790, -312331741, -1081354226, 852492784, -1112633144, 137709111, -642769642, 1609065465, -2005533035, 1760767169, 1149912827, -1157494008,
    -1089051038, 229948825, -1315100187, -2065077512, 283239732, -259685397, -2065403080, -1253055356, -810554097, -2119240350, -2020246557, 290245386, -1196764828, -430082174, -2023068683, -1530756463, -1593497913, -943335595, -1237089419, 1558772237,
    1534650852, -935848119, -296510350, 1317996001, 1126015411, -1560889512, 1690974808, -1950851420, -146673430, 1333255017, 1363065477, -631879641, 2110278323, -1691880458, -129664485, -315284297, -1387413857, -736375570, -992934633, 1092188318,
    425529305, -1113970981, 1804509858, -2035605008, -530609250, -347914681, -963718489, -1502230397, -2145365268, 991880540, 1400869029, 1261554238, 30280569, -801106998, 1019703237, 1475946390, 1555180518, 557256941, 590210094, 1749038166,
    1318344500, 1165597741, -1683075688, 379719838, 1026784119, 763017128, 2027460383, 973942317, 346400712, 1084356878, -1980006311, -19110430, -838152833, -2064874291, -645798998, -282238593, 403562658, -469756051, -1867674154, -611492432,
    -227341417, -350568132, 1181711063, -1625192373, 1453910561, -53462995, 2059832304, -251625767, -599916663, -282074115, -2062873855, -1681477291, -1199907813, 2096957590, 186552093, 1422372147, 1198826964, 1733604024, -958589351, 299537571,
    838006872, 749947606, -1750767386, -1210038762, 700403753, 2097541693, -1667491486, -1593444351, 2091087126, 512888443, -357714326, 548359392, 2025822192, 2134877950, -997588621, 1881088893, -768075900, 1199143162, -2078589222, 1923524465,
    633741508, -1449138800, 1905914680, 1721132523, 79011399, -113631700, -175201797, -911906129, 277752563, 300102446, 504914225, -1606506142, -431227913, -442046260, -1645717849, -1620756732, 2112419327, -144935370, -640716238, -454813764,
    843407779, -1110732038, 2042427724, 1770431707, -1836911841, -1035307351, 1222752226, -379400422, 266082633, 2001317563, 395635307, -552681178, 1831651263, 455929519, 903165244, 1680844382, -687787937, -1071759754, 1129754, 1550293467,
    -1085136901, -1535431919, -1366772464, -1954217552, -161615283, 793894264, 189789571, -315237774, 763908392, 190725053, 554528899, 1738913530, -1189465360, 1331001457, 774477667, 1536522345, 1432276044, 1448129606, -761330293, 2145911404,
    842098969, -1257400843, 1126302859, 1150250944, 282812577, -1832518558, 1479785844, -847607048, -1033856756, -187814147, 874949475, -1713729666, 1934380566, 1161506922, 1834951517, -1961527593, -2064183550, 1825118051, -1284242078, 691623466,
    106571726, 1230213597, -1551832388, 1829343234, 1863575975, -1968114071, 1664902551, -1173954990, 25396894, 568494045, -394648106, 157251769, 337278108, 1754451763, -454420701, 298113799, -1855157357, 319106992, -782054328, -1141313536,
    -781757706, 1529354568, -904475715, -1195596705, -945016214, -1028817600, -352743039, 518399517, -1701807683, 1378052373, -896378324, -1476045838, 1996583959, -2042565732, 247991109, 1130438940, -1095107986, -1187403670, -200094511, 578875742,
    320485695, -164840075, -516610005, 874590539, -959865478, -555098373, -1050165222, -626872636, -1504305987, -627978846, 704640544, -302484034, -75281211, -1002075424, 676008208, 789591368, 321846816, 107605916, -1378043677, -403869492,
    970477095, -1623488235, -1238836278, -1200619116, 573662251, 1086906370, -1926344570, 2017635472, 2062765550, 1193774587, -981939721, -1695100843, 1353625429, -300235497, -250220557, -534876311, -590661286, 967323093, -1367166631, 243669693,
    -275571641, -981319873, -44883099, -1950056326, 122087712, -469928628, -1750564284, 1483580160, -452356512, -2135422586, -1834080533, 563346474, -2126799896, 1668420076, 848266787, 35786967, 1322736180, 521021976, 1793494248, 1312503974,
    -405782321, -40826204, 1153625588, 1887084032, 1452894217, 108573386, 2086679701, -657212838, 34574822, 657066058, 1403629767, 524800699, -1001535912, 129896848, 1627951230, 1842886780, 1504902833, 258354709, 753515074, -1386917298,
    1053987922, 221311237, -1322369791, -1138314879, 1500538536, 1248821793, 1301440800, -1792493693, -1253774247, 93694182, -532355374, -209678426, -262888519, 1701635567, 1537760685, -418414299, 527013506, 1863663255, 785351034, 1882905960,
    1626662084, -472604958, -18048948, -1722937722, -1635153126, -1067453028, -1310011949, 1678805516, 847304734, 1683451586, 1727588337, 193047548, 191644958, -798920671, 1177694350, -1740063208, 822060559, 1910914109, -1240749912, 713535328,
    693757121, 1193828211, -2131175251, -106741800, 155302740, -745256095, 1495061004, 981181581, 156180970, 350471301, 1477522953, 2059200474, 1414620061, 72877604, 253122000, -1398896153, -1546842445, -434651028, 1167900621, -35773070,
    -714329072, -638823204, 38391354, -1892082479, 1391372779, -1905527581, 580782841, 1667601207, 1154434500, 1213499079, -528647005, 365639221, -1582415467, 1840608456, -800640800, -1908368508, 1088438343, -1648047483, 1328191480, 1880766209,
    -662395545, -451001187, 222201258, 740568312, -428002279, -1997457768, 1925638972, -1494186844, -892589748, 210529032, -2125226285, 1400340214, 545080623, -1174052373, -2127313916, 2107643285, -1416529950, -89484973, 526297514, -1792874970,
    -173267599, -188314552, -2136198919, 1738149325, 465319165, 473183213, 2051281363, -189482766, -70623429, -123578656, 1707905114, 2041408327, 918122530, 1231512294, -1890158651, 1435386890, -1654886432, -1179906872, -1131581833, -557923705,
    504489741, -2101472649, -711919795, 1342885600, 257077794, 63601526, -380914633, -1073018096, 1737889836, -2142176392, 375635466, 231911469, -1428940612, -946316472, -667409005, -1052279827, -586537695, -1987703832, -1307774482, -1060343190,
    -558516008, -21411843, -1563938792, 691042345, 796624195, 1558996842, 1991763907, -2074212264, 325657753, 1269123385, 1275201897, -1889957033, -1683322850, 1248327618, 517777828, -51375751, -1419012717, 925690630, 901651899, 1884321290,
    3254254, 68062555, -526791297, -706400620, -1048582322, 876078670, 1513606744, 1499810398, -1856721880, 341348292, 889363354, 1383556661, 1698521542, 1619024226, -1501069283, 1974048878, 698457074, 1518812718, 597394699, -2110940886,
    -574794770, 1330417782, 199227899, 637053659, 835551398, 1751285744, -344004033, 1306199815, -378438104, 157900322, -22473863, -166014132, 1031206995, 514868484, -656133772, 2119885475, 158158030, -739834910, 600945456, -1319778584,
    -977758148, 1879537287, 1929588030, 309982873, -1515461971, 1029352087, -571269810, -1862530339, -575332521, -1008699588, -208809210, -1245685304, 1058861957, 1738959621, 1159696916, 2144170205, 1485273294, 235222026, 641352070, -301124652,
    -209555830, -2104891821, -713671592, 893035420, -1690268030, 1354941562, 1679234894, -1573482078, 1315502310, -243437938, -908693500, 2078131027, 1088220035, -360801478, 1537481027, -266384928, -1044039628, -1516650715, -1454622571, 1320817216,
    -916705639, -1047443812, -1142347494, -453709446, 671083783, -896645778, 118503324, -1726697180, -932950850, 461947159, -1509585951, -1903697882, 1618664801, 65534240, -701181119, 1291348931, 1796907938, -1355525691, -34504585, 149898458,
    1859686204, 506119383, -77941573, 884381032, -1206068186, 1260125412, 1349264911, -1611969968, -2070883579, 1165983380, -133785895, 1542911326, -1614570271, 1011188821, 156218033, -675853431, 60562971, -1980207046, -1536007044, 757646200,
    -837219170, 2070476832, 583399865, 893261895, -666913451, -1213304814, -302799078, 1751561354, 858596572, -1997089042, 1259815510, -371045999, 2135205753, 1329105224, 2035369277, -383772947, 1639044173, -896418163, -1139970548, 458008115,
    -1390176314, -1186974613, -643657470, -937885953, 923332951, 786279536, -1541050573, 1542625083, -772843413, -1506533391, -980310373, -946633823, -1154614122, -691614163, 252252021, 222735485, -1526180595, -379877199, 1444616909, 531892919,
    -903498920, -2052988419, -1341454764, -792383216, 2061684037, 80487015, -484116109, -1317886549, -472026593, -1547163841, -828416094, -514928689, 1718214432, 168071219, -2088299527, 1588297195, 1923376931, -1315905803, -636866042, 713246681,
    248078749, 1764584730, -1889624095, -970960537, -207055666, 583687237, -692148866, 940454162, -1314353358, -951917436, -993581758, -360906988, -1339972546, -1122720519, -316126760, -1558720352, 18841672, -106374468, -665666236, 1538335595,
    554928070, -1111514624, -556221129, 2018245998, 1810986426, -739531404, 1272684709, 1378927850, -1429017235, 1041162219, 206807700, 757666988, -438963366, -1968221122, 1602815543, -873590638, 414548333, -2029723792, 49473595, 529071693,
    1960487533, 219121939, -769568417, 589178471, 613941429, 1209529835, 1067277898, 1184252295, -1607977942, -604905264, -284979048, -954534412, 1629756264, -294470184, -263611083, -1331746473, 1538497598, -1794315340, 425872366, -1208735036,
    285222748, -1398663334, 59194437, -1518798598, 866564938, -1650084380, -1650875516, 629221610, -799890788, 483571896, -1031251948, -916115339, 1233740131, 390455272, 314228238, 453384570, 2034468326, -905949478, -2023397102, 1756029199,
    745885842, -1897117909, -5863593, 1891501837, 1466263342, 1454910928, -560633341, 676729298, -1260452014, -1518715266, -934166851, 1423706689, -1859097575, 1783730507, -2016129409, -1261489139, -742565099, 1180653205, 554456496, -1646950857,
    -1443296125, 129854754, 1475463537, -1422088236, -1273371969, -540690808, 1726357046, -1073253101, 571254010, 1934609871, -230530151, -421506946, -1521209047, 1975583828, 1166723434, -1324825472, -2049058496, 1462028528, -1381178870, -1880934105,
    60940191, 1480711512, 70202873, 993772073, -1335179572, 1745026502, -1097990996, -985577172, -1147836317, -1177559335, -1402335581, 1148229697, -1605957814, 1725801913, -336829253, 2143750321, 347459880, 1665941118, -15615808, 1386928636,
    32736023, -44550959, -1414063290, 1481864478, 644949399, 1195307732, -730230088, 710680596, 2104366022, -1645376961, 2131236785, 802153885, -1175207475, -982488117, 380142218, -1180322491, -400361827, 1117565138, -861585869, 1401946014,
    1655598299, 97639223, -43854778, -1535946032, -1213591784, -1623380093, 1161406041, -1660175532, 1184187205, -269087408, -1792972653, -1384059652, 1962539365, 517794281, 302068097, 941979702, 1717662084, -358821582, -481283286, -392327280
};



/* PROTO_LIST is defined depending on how PROTOTYPES is defined above.
If using PROTOTYPES, then PROTO_LIST returns the list, otherwise it
  returns an empty list.
 */
#if PROTOTYPES
#define PROTO_LIST(list) list
#else
#define PROTO_LIST(list) ()
#endif

/* MD5 context. */
typedef struct {
  UINT4 state[4];                                   /* state (ABCD) */
  UINT4 count[2];        /* number of bits, modulo 2^64 (lsb first) */
  unsigned char buffer[64];                         /* input buffer */
} MD5_CTX;

//void MD5Init PROTO_LIST ((MD5_CTX *));
//void MD5Update PROTO_LIST
//  ((MD5_CTX *, unsigned char *, unsigned int));
//void MD5Final PROTO_LIST ((unsigned char [16], MD5_CTX *));


/* Constants for MD5Transform routine.
 */

#define S11 7
#define S12 12
#define S13 17
#define S14 22
#define S21 5
#define S22 9
#define S23 14
#define S24 20
#define S31 4
#define S32 11
#define S33 16
#define S34 23
#define S41 6
#define S42 10
#define S43 15
#define S44 21

//void MD5Transform PROTO_LIST ((UINT4 [4], unsigned char [64]));

/* F, G, H and I are basic MD5 functions.
 */
#define F(x, y, z) (((x) & (y)) | ((~x) & (z)))
#define G(x, y, z) (((x) & (z)) | ((y) & (~z)))
#define H(x, y, z) ((x) ^ (y) ^ (z))
#define I(x, y, z) ((y) ^ ((x) | (~z)))

/* ROTATE_LEFT rotates x left n bits.
 */
#define ROTATE_LEFT(x, n) (((x) << (n)) | ((x) >> (32-(n))))

/* FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4.
Rotation is separate from addition to prevent recomputation.
 */
#define FF(a, b, c, d, x, s, ac) { \
 (a) += F ((b), (c), (d)) + (x) + (UINT4)(ac); \
 (a) = ROTATE_LEFT ((a), (s)); \
 (a) += (b); \
  }
#define GG(a, b, c, d, x, s, ac) { \
 (a) += G ((b), (c), (d)) + (x) + (UINT4)(ac); \
 (a) = ROTATE_LEFT ((a), (s)); \
 (a) += (b); \
  }
#define HH(a, b, c, d, x, s, ac) { \
 (a) += H ((b), (c), (d)) + (x) + (UINT4)(ac); \
 (a) = ROTATE_LEFT ((a), (s)); \
 (a) += (b); \
  }
#define II(a, b, c, d, x, s, ac) { \
 (a) += I ((b), (c), (d)) + (x) + (UINT4)(ac); \
 (a) = ROTATE_LEFT ((a), (s)); \
 (a) += (b); \
  }

/* MD5 basic transformation. Transforms state based on block.
 */
void MD5Transform (state, x)
UINT4 state[4];
UINT4 x[16];
{
  UINT4 a = state[0], b = state[1], c = state[2], d = state[3] ;

  /* Round 1 */
  FF (a, b, c, d, x[ 0], S11, 0xd76aa478); /* 1 */
  FF (d, a, b, c, x[ 1], S12, 0xe8c7b756); /* 2 */
  FF (c, d, a, b, x[ 2], S13, 0x242070db); /* 3 */
  FF (b, c, d, a, x[ 3], S14, 0xc1bdceee); /* 4 */
  FF (a, b, c, d, x[ 4], S11, 0xf57c0faf); /* 5 */
  FF (d, a, b, c, x[ 5], S12, 0x4787c62a); /* 6 */
  FF (c, d, a, b, x[ 6], S13, 0xa8304613); /* 7 */
  FF (b, c, d, a, x[ 7], S14, 0xfd469501); /* 8 */
  FF (a, b, c, d, x[ 8], S11, 0x698098d8); /* 9 */
  FF (d, a, b, c, x[ 9], S12, 0x8b44f7af); /* 10 */
  FF (c, d, a, b, x[10], S13, 0xffff5bb1); /* 11 */
  FF (b, c, d, a, x[11], S14, 0x895cd7be); /* 12 */
  FF (a, b, c, d, x[12], S11, 0x6b901122); /* 13 */
  FF (d, a, b, c, x[13], S12, 0xfd987193); /* 14 */
  FF (c, d, a, b, x[14], S13, 0xa679438e); /* 15 */
  FF (b, c, d, a, x[15], S14, 0x49b40821); /* 16 */

 /* Round 2 */
  GG (a, b, c, d, x[ 1], S21, 0xf61e2562); /* 17 */
  GG (d, a, b, c, x[ 6], S22, 0xc040b340); /* 18 */
  GG (c, d, a, b, x[11], S23, 0x265e5a51); /* 19 */
  GG (b, c, d, a, x[ 0], S24, 0xe9b6c7aa); /* 20 */
  GG (a, b, c, d, x[ 5], S21, 0xd62f105d); /* 21 */
  GG (d, a, b, c, x[10], S22,  0x2441453); /* 22 */
  GG (c, d, a, b, x[15], S23, 0xd8a1e681); /* 23 */
  GG (b, c, d, a, x[ 4], S24, 0xe7d3fbc8); /* 24 */
  GG (a, b, c, d, x[ 9], S21, 0x21e1cde6); /* 25 */
  GG (d, a, b, c, x[14], S22, 0xc33707d6); /* 26 */
  GG (c, d, a, b, x[ 3], S23, 0xf4d50d87); /* 27 */

  GG (b, c, d, a, x[ 8], S24, 0x455a14ed); /* 28 */
  GG (a, b, c, d, x[13], S21, 0xa9e3e905); /* 29 */
  GG (d, a, b, c, x[ 2], S22, 0xfcefa3f8); /* 30 */
  GG (c, d, a, b, x[ 7], S23, 0x676f02d9); /* 31 */
  GG (b, c, d, a, x[12], S24, 0x8d2a4c8a); /* 32 */

  /* Round 3 */
  HH (a, b, c, d, x[ 5], S31, 0xfffa3942); /* 33 */
  HH (d, a, b, c, x[ 8], S32, 0x8771f681); /* 34 */
  HH (c, d, a, b, x[11], S33, 0x6d9d6122); /* 35 */
  HH (b, c, d, a, x[14], S34, 0xfde5380c); /* 36 */
  HH (a, b, c, d, x[ 1], S31, 0xa4beea44); /* 37 */
  HH (d, a, b, c, x[ 4], S32, 0x4bdecfa9); /* 38 */
  HH (c, d, a, b, x[ 7], S33, 0xf6bb4b60); /* 39 */
  HH (b, c, d, a, x[10], S34, 0xbebfbc70); /* 40 */
  HH (a, b, c, d, x[13], S31, 0x289b7ec6); /* 41 */
  HH (d, a, b, c, x[ 0], S32, 0xeaa127fa); /* 42 */
  HH (c, d, a, b, x[ 3], S33, 0xd4ef3085); /* 43 */
  HH (b, c, d, a, x[ 6], S34,  0x4881d05); /* 44 */
  HH (a, b, c, d, x[ 9], S31, 0xd9d4d039); /* 45 */
  HH (d, a, b, c, x[12], S32, 0xe6db99e5); /* 46 */
  HH (c, d, a, b, x[15], S33, 0x1fa27cf8); /* 47 */
  HH (b, c, d, a, x[ 2], S34, 0xc4ac5665); /* 48 */

  /* Round 4 */
  II (a, b, c, d, x[ 0], S41, 0xf4292244); /* 49 */
  II (d, a, b, c, x[ 7], S42, 0x432aff97); /* 50 */
  II (c, d, a, b, x[14], S43, 0xab9423a7); /* 51 */
  II (b, c, d, a, x[ 5], S44, 0xfc93a039); /* 52 */
  II (a, b, c, d, x[12], S41, 0x655b59c3); /* 53 */
  II (d, a, b, c, x[ 3], S42, 0x8f0ccc92); /* 54 */
  II (c, d, a, b, x[10], S43, 0xffeff47d); /* 55 */
  II (b, c, d, a, x[ 1], S44, 0x85845dd1); /* 56 */
  II (a, b, c, d, x[ 8], S41, 0x6fa87e4f); /* 57 */
  II (d, a, b, c, x[15], S42, 0xfe2ce6e0); /* 58 */
  II (c, d, a, b, x[ 6], S43, 0xa3014314); /* 59 */
  II (b, c, d, a, x[13], S44, 0x4e0811a1); /* 60 */
  II (a, b, c, d, x[ 4], S41, 0xf7537e82); /* 61 */
  II (d, a, b, c, x[11], S42, 0xbd3af235); /* 62 */
  II (c, d, a, b, x[ 2], S43, 0x2ad7d2bb); /* 63 */
  II (b, c, d, a, x[ 9], S44, 0xeb86d391); /* 64 */

  state[0] += a;
  state[1] += b;
  state[2] += c;
  state[3] += d;

}

int main() {


	//UINT4 state[4];
	//UINT4 x[16];
	int i;

	for(i=0; i<BLOCKS; i++) {
		MD5Transform(&states[i*4], &x[i*16]);
	}

	return 0;
}
